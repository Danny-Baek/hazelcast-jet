<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Testing · Hazelcast Jet</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Test support offered by Jet for testing the correctness of your processing pipelines."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Testing · Hazelcast Jet"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jet-start.sh/"/><meta property="og:description" content="Test support offered by Jet for testing the correctness of your processing pipelines."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jet-start.sh/blog/atom.xml" title="Hazelcast Jet Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jet-start.sh/blog/feed.xml" title="Hazelcast Jet Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-158279495-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,500,600"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,500,600,700,800"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo-dark.svg" alt="Hazelcast Jet"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/get-started/intro" target="_self">Documentation</a></li><li class=""><a href="https://github.com/hazelcast/hazelcast-jet/releases" target="_self">Download</a></li><li class=""><a href="https://github.com/hazelcast/hazelcast-jet" target="_self">View on GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Programming Guide</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Get Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/get-started/intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/get-started/first-job">Your First Jet Program</a></li><li class="navListItem"><a class="navItem" href="/docs/get-started/installation">Set Up a Jet Cluster</a></li><li class="navListItem"><a class="navItem" href="/docs/get-started/submit-job">Submit a Job to the Cluster</a></li><li class="navListItem"><a class="navItem" href="/docs/get-started/scale-job">Scale Your Job</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Programming Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/api/pipeline">Building Pipelines</a></li><li class="navListItem"><a class="navItem" href="/docs/api/stateless-transforms">Stateless Transforms</a></li><li class="navListItem"><a class="navItem" href="/docs/api/stateful-transforms">Stateful Transforms</a></li><li class="navListItem"><a class="navItem" href="/docs/api/sources-sinks">Sources and Sinks</a></li><li class="navListItem"><a class="navItem" href="/docs/api/data-structures">Distributed Data Structures</a></li><li class="navListItem"><a class="navItem" href="/docs/api/serialization">Serialization</a></li><li class="navListItem"><a class="navItem" href="/docs/api/classloading">Class and Resource Deployment</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/api/testing">Testing</a></li><li class="navListItem"><a class="navItem" href="/docs/api/javadoc">Javadoc</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/concepts/dag">Directed Acylic Graph (DAG)</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/event-time">Streaming and Event Time</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/processing-guarantees">Processing Guarantees for Stateful Computation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tutorials<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/tutorials/map-join">Join Static Data to a Stream</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/kafka">Work with Apache Kafka</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/observables">Reactive Streams</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/cdc">Change Data Capture</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/source-and-sink-builder">Custom Sources and Sinks</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/stream-imap">Stream Changes from IMap</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/python">Apply Transforms using Python</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/windowing">Windowed Aggregation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Operations Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/operations/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/operations/cluster-sizing">Cluster Sizing</a></li><li class="navListItem"><a class="navItem" href="/docs/operations/job-management">Job Management</a></li><li class="navListItem"><a class="navItem" href="/docs/operations/kubernetes">Jet on Kubernetes</a></li><li class="navListItem"><a class="navItem" href="/docs/operations/monitoring">Monitoring and Metrics</a></li><li class="navListItem"><a class="navItem" href="/docs/operations/spring">Spring Integration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Architecture<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/architecture/cluster-topology">Cluster Topology</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture/distributed-computing">Distributed Execution</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture/execution-engine">Cooperative Threading</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture/fault-tolerance">Fault Tolerance</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture/in-memory-storage">In-Memory Storage</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture/event-time-processing">Event Time-Based Processing</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Design Documents<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/design-docs/kafka-connect">Kafka Connect Source</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Roadmap<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/roadmap">Roadmap</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/hazelcast/hazelcast-jet/edit/docs/site/docs/api/testing.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Testing</h1></header><article><div><span><p>Hazelcast Jet project uses JUnit testing framework to test
itself in various scenarios. Over the years there has been some
repetition within the test implementations and it led us to come up
with our own set of convenience methods for testing.</p>
<p>Hazelcast Jet provides test support classes to verify correctness of
your pipelines. Those support classes and the test sources are published
to the Maven central repository for each version with the <code>tests</code>
classifier.</p>
<p>To start using them, please add following dependencies to your
project:</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-13-tab-14" class="nav-link active" data-group="group_13" data-tab="tab-group-13-content-14">Gradle</div><div id="tab-group-13-tab-15" class="nav-link" data-group="group_13" data-tab="tab-group-13-content-15">Maven</div></div><div class="tab-content"><div id="tab-group-13-content-14" class="tab-pane active" data-group="group_13" tabindex="-1"><div><span><pre><code class="hljs css language-bash">compile <span class="hljs-string">'com.hazelcast.jet:hazelcast-jet-core:4.0:tests'</span><br />compile <span class="hljs-string">'com.hazelcast:hazelcast:4.0:tests'</span><br /></code></pre>
</span></div></div><div id="tab-group-13-content-15" class="tab-pane" data-group="group_13" tabindex="-1"><div><span><pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hazelcast.jet<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hazelcast-jet-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>tests<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span><br /><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br /><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hazelcast<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hazelcast<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>tests<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span><br /><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br /></code></pre>
</span></div></div></div></div>
<p>After adding the dependencies to your project, the test classes should
be available to your project.</p>
<h2><a class="anchor" aria-hidden="true" id="creating-hazelcast-jet-instances-with-mock-network"></a><a href="#creating-hazelcast-jet-instances-with-mock-network" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Hazelcast Jet instances with Mock Network</h2>
<p>Test utilities contains factory methods to create Hazelcast Jet
instances with the mock network stack. Those Hazelcast Jet nodes
communicate with each other using intra-process communication methods.
This means we can create multiple lightweight Hazelcast Jet instances
in our tests without using any networking resources.</p>
<p>To create Hazelcast Jet instances with mock network(along with a lot
of convenience methods), one needs to extend <code>com.hazelcast.jet.core.JetTestSupport</code>
class.</p>
<p>Here is a simple test harness which creates 2 node Hazelcast Jet cluster
with mock network:</p>
<pre><code class="hljs css language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClusteringTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> given_2nodeCluster_when<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_then<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// given</span>
        <span class="token class-name">JetInstance</span> instance1 <span class="token operator">=</span> <span class="token function">createJetMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JetInstance</span> instance2 <span class="token operator">=</span> <span class="token function">createJetMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Alternatively</span>
        <span class="token comment">// JetInstance[] instances = createJetMembers(2);</span>

        <span class="token comment">// when</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// then</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If needed, a <code>JetConfig</code> object can be passed to the factory methods
like below:</p>
<pre><code class="hljs css language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClusteringTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> given_2nodeClusterWith16CooperativeThreads_when<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_then<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// given</span>
        <span class="token class-name">JetConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JetConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">getInstanceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCooperativeThreadCount</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JetInstance</span><span class="token punctuation">[</span><span class="token punctuation">]</span> instances <span class="token operator">=</span> <span class="token function">createJetMembers</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// when</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// then</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Similar to the Hazelcast Jet nodes, one can create Hazelcast Jet clients
with the same factories. There is no need to provide any network
configuration for clients to discover nodes since they are using the
same factory. The discovery will work out of the box.</p>
<pre><code class="hljs css language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClusteringTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> given_2nodeClusterAndClient_when<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_then<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// given</span>
        <span class="token class-name">JetInstance</span><span class="token punctuation">[</span><span class="token punctuation">]</span> instances <span class="token operator">=</span> <span class="token function">createJetMembers</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JetInstance</span> client <span class="token operator">=</span> <span class="token function">createJetClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// when</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// then</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>When the above test run it should create 2 Hazelcast Jet nodes and a
Hazelcast Jet client connected to them. When run, it can be verified
that they form the cluster from the logs and client connected to them.</p>
<pre><code class="hljs css language-log"><span class="hljs-number">10</span>:<span class="hljs-number">45</span>:<span class="hljs-number">03.927</span> [ INFO] [c.h.i.c.ClusterService]
....
Members {size:<span class="hljs-number">2</span>, ver:<span class="hljs-number">2</span>} [
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> - <span class="hljs-number">93328</span>d97<span class="hljs-number">-0975</span><span class="hljs-number">-4</span>dfa-bf56<span class="hljs-number">-4</span>d46e8a469a1 <span class="hljs-keyword">this</span>
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5702</span> - <span class="hljs-number">920</span>d1b0c<span class="hljs-number">-0898</span><span class="hljs-number">-4</span>b6e<span class="hljs-number">-9009</span><span class="hljs-number">-8f</span>29889d6a77
]

<span class="hljs-number">10</span>:<span class="hljs-number">45</span>:<span class="hljs-number">03.933</span> [ INFO] [c.h.i.c.ClusterService]

Members {size:<span class="hljs-number">2</span>, ver:<span class="hljs-number">2</span>} [
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> - <span class="hljs-number">93328</span>d97<span class="hljs-number">-0975</span><span class="hljs-number">-4</span>dfa-bf56<span class="hljs-number">-4</span>d46e8a469a1
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5702</span> - <span class="hljs-number">920</span>d1b0c<span class="hljs-number">-0898</span><span class="hljs-number">-4</span>b6e<span class="hljs-number">-9009</span><span class="hljs-number">-8f</span>29889d6a77 <span class="hljs-keyword">this</span>
]
....
<span class="hljs-number">10</span>:<span class="hljs-number">45</span>:<span class="hljs-number">04.890</span> [ INFO] [c.h.c.i.s.ClientClusterService] [<span class="hljs-number">4.0</span>]

Members [<span class="hljs-number">2</span>] {
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> - <span class="hljs-number">93328</span>d97<span class="hljs-number">-0975</span><span class="hljs-number">-4</span>dfa-bf56<span class="hljs-number">-4</span>d46e8a469a1
 Member [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5702</span> - <span class="hljs-number">920</span>d1b0c<span class="hljs-number">-0898</span><span class="hljs-number">-4</span>b6e<span class="hljs-number">-9009</span><span class="hljs-number">-8f</span>29889d6a77
}
</code></pre>
<p>First two blocks are the member list printed from each member's point
of view and the last one is the cluster from the client's point of view.</p>
<p>So far, we've seen how to create any number of Hazelcast Jet clusters
and clients using factory methods provided within the <code>com.hazelcast.jet.core.JetTestSupport</code>
class to create the test environments. Let's explore other utilities to
write meaningful test.</p>
<h2><a class="anchor" aria-hidden="true" id="integration-tests"></a><a href="#integration-tests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integration Tests</h2>
<p>For integration testing, there might be a need to create real instances
without the mock network. For those cases one can create real instances
with <code>Jet.newJetInstance()</code> method.</p>
<h2><a class="anchor" aria-hidden="true" id="using-random-cluster-names"></a><a href="#using-random-cluster-names" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using random cluster names</h2>
<p>If multiple tests are running in parallel there is chance that the
clusters in each test can discover others, intefere the test
execution and most of the time causing both of them to fail.</p>
<p>To avoid such scenarios, one needs to isolate the clusters in each test
execution by giving them unique cluster names. This way, they won't
try to connect each other since the nodes will only try to connect to
other members with the same cluster name property.</p>
<p>Random cluster name for each test execution can be generated like
below:</p>
<pre><code class="hljs css language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClusteringTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> given_2nodeClusterAndClient_when<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_then<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// given</span>
        <span class="token class-name">String</span> clusterName <span class="token operator">=</span> <span class="token function">randomName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JetConfig</span> jetConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JetConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jetConfig<span class="token punctuation">.</span><span class="token function">getHazelcastConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setClusterName</span><span class="token punctuation">(</span>clusterName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JetInstance</span><span class="token punctuation">[</span><span class="token punctuation">]</span> instances <span class="token operator">=</span> <span class="token function">createJetMembers</span><span class="token punctuation">(</span>jetConfig<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JetClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JetClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        clientConfig<span class="token punctuation">.</span><span class="token function">setClusterName</span><span class="token punctuation">(</span>clusterName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JetInstance</span> client <span class="token operator">=</span> <span class="token function">createJetClient</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// when</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// then</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In the example above <code>randomName()</code> utility method has been used to
generate a random string from <code>com.hazelcast.jet.core.JetTestSupport</code>
class.</p>
<h2><a class="anchor" aria-hidden="true" id="cleaning-up-the-resources"></a><a href="#cleaning-up-the-resources" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cleaning up the resources</h2>
<p>Mock instances created from the factory of <code>com.hazelcast.jet.core.JetTestSupport</code>
are cleaned-up automatically after the test execution has been finished.</p>
<p>If the test contains real instances, then they either needs to be
tracked individually and shut down when the test finished or one can
write a teardown method like below to shut down all instances created.</p>
<pre><code class="hljs css language-java">    <span class="token annotation punctuation">@After</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Jet</span><span class="token punctuation">.</span><span class="token function">shutdownAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>Either way one has to shut down Hazelcast Jet instances after the test
has been finished to reclaim resources and not to leave a room for
interference with the next test execution due to distributed
nature of the product.</p>
<h2><a class="anchor" aria-hidden="true" id="test-sources-and-sinks"></a><a href="#test-sources-and-sinks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Test Sources and Sinks</h2>
<p>Hazelcast Jet comes with batch and streaming test sources along with a
assertion sinks where you can write tests to assert the output of a
pipeline without having to write boilerplate code.</p>
<p>Test sources allow you to generate events for your pipeline.</p>
<h3><a class="anchor" aria-hidden="true" id="batch-source"></a><a href="#batch-source" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Batch Source</h3>
<p>These sources create a fixed amount of data. These sources are
non-distributed.</p>
<pre><code class="hljs css language-java"><span class="token class-name">Pipeline</span> p <span class="token operator">=</span> <span class="token class-name">Pipeline</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">readFrom</span><span class="token punctuation">(</span><span class="token class-name">TestSources</span><span class="token punctuation">.</span><span class="token function">items</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">writeTo</span><span class="token punctuation">(</span><span class="token class-name">Sinks</span><span class="token punctuation">.</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This will yield an output like below:</p>
<pre><code class="hljs css language-log"><span class="hljs-number">10</span>:<span class="hljs-number">25</span>:<span class="hljs-number">50</span>,<span class="hljs-number">198</span>  INFO |batchSource| - [loggerSink#<span class="hljs-number">0</span>] hz.cocky_lichterman.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] <span class="hljs-number">1</span>
<span class="hljs-number">10</span>:<span class="hljs-number">25</span>:<span class="hljs-number">50</span>,<span class="hljs-number">199</span>  INFO |batchSource| - [loggerSink#<span class="hljs-number">0</span>] hz.cocky_lichterman.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] <span class="hljs-number">2</span>
<span class="hljs-number">10</span>:<span class="hljs-number">25</span>:<span class="hljs-number">50</span>,<span class="hljs-number">200</span>  INFO |batchSource| - [loggerSink#<span class="hljs-number">0</span>] hz.cocky_lichterman.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] <span class="hljs-number">3</span>
<span class="hljs-number">10</span>:<span class="hljs-number">25</span>:<span class="hljs-number">50</span>,<span class="hljs-number">200</span>  INFO |batchSource| - [loggerSink#<span class="hljs-number">0</span>] hz.cocky_lichterman.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] <span class="hljs-number">4</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="streaming-source"></a><a href="#streaming-source" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Streaming Source</h3>
<p>Streaming sources create an infinite stream of data. The generated
events have timestamps and like the batch source, this source is also
non-distributed.</p>
<pre><code class="hljs css language-java"><span class="token keyword">int</span> itemsPerSecond <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
pipeline<span class="token punctuation">.</span><span class="token function">readFrom</span><span class="token punctuation">(</span><span class="token class-name">TestSources</span><span class="token punctuation">.</span><span class="token function">itemStream</span><span class="token punctuation">(</span>itemsPerSecond<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withNativeTimestamp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">writeTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The source above will emit data as follows:</p>
<pre><code class="hljs css language-log"><span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">27</span>,<span class="hljs-number">654</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">27.500</span>, sequence=<span class="hljs-number">0</span>)
<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">28</span>,<span class="hljs-number">146</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">28.000</span>, sequence=<span class="hljs-number">1</span>)
<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">28</span>,<span class="hljs-number">647</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">28.500</span>, sequence=<span class="hljs-number">2</span>)
<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">29</span>,<span class="hljs-number">145</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">29.000</span>, sequence=<span class="hljs-number">3</span>)
<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">29</span>,<span class="hljs-number">648</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">29.500</span>, sequence=<span class="hljs-number">4</span>)
<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">30</span>,<span class="hljs-number">147</span>  INFO |streamingSource| - [loggerSink#<span class="hljs-number">0</span>] hz.competent_margulis.jet.blocking.thread<span class="hljs-number">-1</span> - [<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>]:<span class="hljs-number">5701</span> [jet] [<span class="hljs-number">4.0</span>-SNAPSHOT] (timestamp=<span class="hljs-number">10</span>:<span class="hljs-number">28</span>:<span class="hljs-number">30.000</span>, sequence=<span class="hljs-number">5</span>)
</code></pre>
<p>For more detailed information regarding test sources and sinks
please see the <a href="/docs/design-docs/unit-testing-support">design document</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="assertions"></a><a href="#assertions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Assertions</h2>
<p><code>com.hazelcast.jet.core.JetTestSupport</code> contains a lot of assertion
methods which can be used to verify whether the job/member/cluster is
in desired state.</p>
<h2><a class="anchor" aria-hidden="true" id="class-runners"></a><a href="#class-runners" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Class Runners</h2>
<p>There are multiple JUnit test class runners shipped with the tests
package which gives various abilities.</p>
<p>The common features are:</p>
<ul>
<li>Ability to print a thread dump in case of a test failure, configured
via <code>hazelcast.test.threadDumpOnFailure</code> property</li>
<li>Supports repetitive test execution</li>
<li>Uses mock networking, unless configured to use real networking via <code>hazelscast.test.use.network</code>
property</li>
<li>Disabled phone-home feature, configured via <code>hazelcast.phone.home.enabled</code>
property</li>
<li>Have shorter(1 sec) wait time before joining than default(5 secs).
This leads to faster cluster formation and test execution, configured
via <code>hazelcast.wait.seconds.before.join</code> property.</li>
<li>Uses loopback address, configured via <code>hazelcast.local.localAddress</code>
property</li>
<li>Uses IPv4 stack, configured via <code>java.net.preferIPv4Stack</code>
property</li>
<li>Prints out test execution duration after they finish execution</li>
</ul>
<p>Let's have a look at them in detail:</p>
<h3><a class="anchor" aria-hidden="true" id="serial-class-runner"></a><a href="#serial-class-runner" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serial Class Runner</h3>
<p><code>com.hazelcast.test.HazelcastSerialClassRunner</code> is a JUnit test class
runner which runs the tests in series. Nothing fancy, it just executes
the tests with the features listed above.</p>
<h3><a class="anchor" aria-hidden="true" id="parallel-class-runner"></a><a href="#parallel-class-runner" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parallel Class Runner</h3>
<p><code>com.hazelcast.test.HazelcastParallelClassRunner</code> is a JUnit test class
runner which runs the tests in parallel with multiple threads. If the
test methods within the test class does not share any resources this
yields a faster execution compared to it's serial counterpart.</p>
<h3><a class="anchor" aria-hidden="true" id="repetitive-test-execution"></a><a href="#repetitive-test-execution" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Repetitive Test Execution</h3>
<p>While dealing with intermittently failing tests, it is helpful to run
the test multiple times in series to increase chances to make it
fail. In those cases <code>com.hazelcast.test.annotation.Repeat</code> annotation
can be used to run the test repeatadly. <code>@Repeat</code> annotation can be
used on both the class and method level. On the class level it repeats the
whole class execution specified tiems. On the method level it only
repeats particular test method.</p>
<p>Follwing is an example test which repeats the test method execution
5 times:</p>
<pre><code class="hljs css language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">HazelcastSerialClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RepetitiveTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Test method to be implemented!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>When run, it logs like the following:</p>
<pre><code class="hljs css language-log">Started Running Test: test
---&gt; Repeating test [RepetitiveTest:test], run count [1]
<span class="hljs-keyword">Test </span>method to be implemented!
---&gt; Repeating test [RepetitiveTest:test], run count [2]
<span class="hljs-keyword">Test </span>method to be implemented!
---&gt; Repeating test [RepetitiveTest:test], run count [3]
<span class="hljs-keyword">Test </span>method to be implemented!
---&gt; Repeating test [RepetitiveTest:test], run count [4]
<span class="hljs-keyword">Test </span>method to be implemented!
---&gt; Repeating test [RepetitiveTest:test], run count [5]
<span class="hljs-keyword">Test </span>method to be implemented!
Finished Running Test: test in 0.009 seconds.
</code></pre>
<blockquote>
<p>Note: <code>@Repeat</code> annotation only works with Hazelcast Class runners.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="waiting-for-job-to-be-in-desired-state"></a><a href="#waiting-for-job-to-be-in-desired-state" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Waiting for job to be in desired state</h2>
<p>On some use cases, one needs to make the job is submitted and running
on the cluster before generating any events on the controlled source
to observe results. To achieve that following assertion could be used
to validate job is in the desired state.</p>
<pre><code class="hljs css language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DesiredStateTest</span> <span class="token keyword">extends</span> <span class="token class-name">JetTestSupport</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> given_singeNodeJet_when_jobIsRunning__then<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// given</span>
        <span class="token class-name">JetInstance</span> jet <span class="token operator">=</span> <span class="token function">createJetMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// when</span>
        <span class="token class-name">Pipeline</span> p <span class="token operator">=</span> <span class="token function">buildPipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Job</span> job <span class="token operator">=</span> jet<span class="token punctuation">.</span><span class="token function">newJob</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertJobStatusEventually</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token class-name">JobStatus</span><span class="token punctuation">.</span>RUNNING<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// then</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In the example above <code>assertJobStatusEventually(Job, JobStatus)</code>
utility method has been used to validate the job is in the desired
state from the <code>com.hazelcast.jet.core.JetTestSupport</code> class.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/api/classloading"><span class="arrow-prev">← </span><span>Class and Resource Deployment</span></a><a class="docs-next button" href="/docs/api/javadoc"><span>Javadoc</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#creating-hazelcast-jet-instances-with-mock-network">Creating Hazelcast Jet instances with Mock Network</a></li><li><a href="#integration-tests">Integration Tests</a></li><li><a href="#using-random-cluster-names">Using random cluster names</a></li><li><a href="#cleaning-up-the-resources">Cleaning up the resources</a></li><li><a href="#test-sources-and-sinks">Test Sources and Sinks</a><ul class="toc-headings"><li><a href="#batch-source">Batch Source</a></li><li><a href="#streaming-source">Streaming Source</a></li></ul></li><li><a href="#assertions">Assertions</a></li><li><a href="#class-runners">Class Runners</a><ul class="toc-headings"><li><a href="#serial-class-runner">Serial Class Runner</a></li><li><a href="#parallel-class-runner">Parallel Class Runner</a></li><li><a href="#repetitive-test-execution">Repetitive Test Execution</a></li></ul></li><li><a href="#waiting-for-job-to-be-in-desired-state">Waiting for job to be in desired state</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo-light.svg" alt="Hazelcast Jet" width="200" height="40"/></a><div><h5>Docs</h5><a href="/docs/get-started/intro">Get Started</a><a href="/docs/concepts/dag">Concepts and Architecture</a><a href="/docs/tutorials/kafka">Tutorials</a><a href="/docs/operations/configuration">Operations Guide</a></div><div><h5>Community</h5><a href="https://groups.google.com/forum/#!forum/hazelcast-jet" target="_blank" rel="noreferrer noopener">Google Groups</a><a href="http://stackoverflow.com/questions/tagged/hazelcast-jet" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://gitter.im/hazelcast/hazelcast-jet">Gitter Chat</a></div><div><h5>Latest From the Blog</h5><a href="/blog/2020/02/20/transactional-processors">Transactional connectors in Hazelcast Jet</a><a href="/blog/2020/01/28/new-website">Announcing New Documentation Website</a><a href="/blog/2019/11/12/stream-deduplication">Stream Deduplication with Hazelcast Jet</a></div><div><h5>More</h5><a href="https://github.com/hazelcast/hazelcast-jet">GitHub Project</a><a href="https://github.com/hazelcast/hazelcast-jet/issues">Issue Tracker</a><a href="http://hazelcast.com/company/careers/">Work at Hazelcast</a><a class="github-button" href="https://github.com/hazelcast/hazelcast-jet" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2020 Hazelcast Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '79d1e4941621b9fd761d279d4d19ed69',
                indexName: 'hazelcast-jet',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>